{% extends 'base.html' %}
{% block title %}Market{% endblock %}

{% block content %}

<div class="container mt-4">

    <!-- Search + Category -->
    <div class="row mb-4">
        <div class="col-md-8">
            <form method="GET">
                <input type="text" name="search" class="form-control"
                       placeholder="Search products..."
                       value="{{ request.args.get('search', '') }}">
            </form>
        </div>

        <div class="col-md-4">
            <form method="GET">
                <select name="category" class="form-control" onchange="this.form.submit()">
                    <option value="">All Categories</option>
                    <option value="phones">Phones</option>
                    <option value="laptops">Laptops</option>
                    <option value="watch">Watches</option>
                </select>
            </form>
        </div>
    </div>

    <!-- âœ… PRODUCTS GRID -->
    <div class="row">

        {% for item in items %}
        <div class="col-md-4 mb-4">
            <div class="card product-card">

                <img src="{{ item.image or url_for('static', filename='default.png') }}"
                     style="height:240px; width:100%; object-fit:cover; border-radius:12px 12px 0 0;">

                <div class="card-body">
                    <h5 class="card-title">{{ item.name }}</h5>
                    <p class="text-success font-weight-bold">{{ item.price }}$</p>

                    <button class="btn btn-info btn-block modern-btn"
                        data-toggle="modal"
                        data-target="#info-{{ item.id }}">More Info</button>

                    <button class="btn btn-success btn-block modern-btn mt-2"
                        data-toggle="modal"
                        data-target="#buy-{{ item.id }}">Purchase</button>
                </div>
            </div>
        </div>

        {% include 'includes/items_modals.html' %}
        {% endfor %}

        {% if items|length == 0 %}
        <div class="col-12 text-center text-muted mt-4">
            <h5>No products found.</h5>
        </div>
        {% endif %}

    </div>
</div>

{% endblock %}
